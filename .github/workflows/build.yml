name: Debug Buildozer
on: [push]
jobs:
  debug:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
      - name: Quick Setup
        run: |
          sudo apt update
          sudo apt install -y python3-pip openjdk-11-jdk
          pip3 install buildozer
      - name: Run Buildozer and Capture Error
        run: |
          # اجرای buildozer و ذخیره خروجی کامل
          buildozer android debug 2>&1 | tee full_log.txt
          echo "=== Build Finished ==="
          
          # بررسی آیا APK ساخته شده
          if ls bin/*.apk 2>/dev/null; then
            echo "✅ APK ساخته شد!"
          else
            echo "❌ APK ساخته نشد! خطا:"
            tail -50 full_log.txt | grep -A10 -B10 "error\|Error\|ERROR\|failed\|Failed"
          fi
